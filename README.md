# üõ†Ô∏è Infra ‚Äî –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –Ω–∞ VPS

–≠—Ç–æ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—É—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É, –∫–æ—Ç–æ—Ä–∞—è —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç—Å—è –Ω–∞ —á–∏—Å—Ç–æ–π VPS –æ–¥–Ω–∏–º –Ω–∞–∂–∞—Ç–∏–µ–º —á–µ—Ä–µ–∑ GitHub Actions.

---

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

* –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Docker –∏ Docker Compose –Ω–∞ VPS
* –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –Ω–∞ VPS –≤ `/opt/infra`
* –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤: PostgreSQL, Redis, Nginx
* –ü–æ–≤—Ç–æ—Ä–Ω—ã–π –¥–µ–ø–ª–æ–π –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ `Run workflow`
* –ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ VPS (wipe) –≤ 1 –∫–ª–∏–∫

---

## üì¶ –°–µ—Ä–≤–∏—Å—ã

| –°–µ—Ä–≤–∏—Å     | –í–µ—Ä—Å–∏—è   | –ü–æ—Ä—Ç   |
| ---------- | -------- | ------ |
| PostgreSQL | `15`     | `5432` |
| Redis      | `alpine` | `6379` |
| Nginx      | `alpine` | `80`   |

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –Ω–∞ VPS

```
/opt
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îú‚îÄ‚îÄ db/        # Volume –¥–ª—è PostgreSQL
‚îÇ   ‚îî‚îÄ‚îÄ redis/     # Volume –¥–ª—è Redis
‚îî‚îÄ‚îÄ infra/         # –≠—Ç–æ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π (–∫–ª–æ–Ω–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –¥–µ–ø–ª–æ–µ)
```

---

## üîê –ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ Secrets

–î–æ–±–∞–≤—å –≤ GitHub ‚Üí Settings ‚Üí Secrets ‚Üí Actions:

| –ù–∞–∑–≤–∞–Ω–∏–µ      | –û–ø–∏—Å–∞–Ω–∏–µ                     |
| ------------- | ---------------------------- |
| `VPS_IP`      | IP-–∞–¥—Ä–µ—Å VPS                 |
| `VPS_USER`    | SSH-–ª–æ–≥–∏–Ω     |
| `VPS_SSH_KEY` | –ü—Ä–∏–≤–∞—Ç–Ω—ã–π SSH-–∫–ª—é—á –±–µ–∑ –ø–∞—Ä–æ–ª—è |

---

## üîß Workflow-—Ñ–∞–π–ª—ã

### 1. `bootstrap-vps.yml`

üìç –†–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É —Å –Ω—É–ª—è –∏–ª–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç –µ—ë

* –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç Docker
* –ö–ª–æ–Ω–∏—Ä—É–µ—Ç/–æ–±–Ω–æ–≤–ª—è–µ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
* –ó–∞–ø—É—Å–∫–∞–µ—Ç `docker-compose up -d`

üîÅ –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –≤—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ –≤–∫–ª–∞–¥–∫—É `Actions ‚Üí Bootstrap VPS (Full Setup)`

---

### 2. `wipe-vps.yml`

üß® –ü–æ–ª–Ω–æ—Å—Ç—å—é –æ—á–∏—â–∞–µ—Ç VPS –¥–æ –∑–∞–≤–æ–¥—Å–∫–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è

* –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∏ —É–¥–∞–ª—è–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã/–æ–±—Ä–∞–∑—ã
* –£–¥–∞–ª—è–µ—Ç Docker –∏ –≤—Å–µ –¥–∞–Ω–Ω—ã–µ
* –£–¥–∞–ª—è–µ—Ç `/opt/infra` –∏ `/opt/data`

‚úÖ –ó–∞—â–∏—â—ë–Ω –æ—Ç –∑–∞–ø—É—Å–∫–∞ –¥—Ä—É–≥–∏–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏:

```yaml
if: github.actor == '–¢–í–û–ô_GITHUB_–Æ–ó–ï–†–ù–ï–ô–ú'
```

---

## üß™ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

* `docker ps` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∑–∞–ø—É—â–µ–Ω–Ω—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
* `curl http://your.vps.ip` –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç Nginx (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω)
* `psql` –∏ `redis-cli` –¥–æ—Å—Ç—É–ø–Ω—ã –ø–æ —Å–≤–æ–∏–º –ø–æ—Ä—Ç–∞–º

---

## üìå –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
sudo docker ps

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã –≤—Ä—É—á–Ω—É—é (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
cd /opt/infra
sudo docker-compose restart
```

---